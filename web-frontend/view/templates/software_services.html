<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><link href="/view/templates/images/common.css" rel="stylesheet" type="text/css" /><link rel="stylesheet" href="/view/templates/js/jquery-ui/jquery-ui-1.10.1.custom.min.css"><script src="/view/templates/js/jquery.min.js"></script><script src="/view/templates/js/jquery-ui/jquery-ui-1.10.1.custom.min.js"></script><script src="/view/templates/js/common.js"></script><title>服务管理</title><script>function get_status(service){    var retcode = false    var ret = restful_ajax({url:"/model/software/service/" + service, type:"GET", async:false, error:function(XMLHttpRequest, textStatus, errorThrown)    {        retcode = false    }, success:function()    {        retcode = true;    }});    if (retcode)    {        var ret_data = $$.parseJSON(ret)        return ret_data["status"];    }    return null;}function done(service, status){          var data = '{"name":"' + service + '","status":"' + status + '"}';        var ret = restful_ajax({url:"/model/software/service", type:"PUT", data:data, async:true, error:function(XMLHttpRequest, textStatus, errorThrown)        {            alert(errorThrown)        }, success:function()        {            alert("操作成功！")            $$("#grid").vmxGridReload();        }});}function stop_process(grid){        var service = $$(grid).get(0).children[1].innerText.replace("\n", '');    var del_confirm = confirm('确定关闭' + service + '吗?')    if (!del_confirm)        return;        var status = get_status(service);    if (status == "stopped")    {        alert("此服务已是关闭状态!")        return;    }    if (status != null)        done(service, "stop");}function start_process(grid){    var service = $$(grid).get(0).children[1].innerText.replace("\n", '');    var status = get_status(service);    if (status == "running")    {        alert("此服务已是运行状态!")        return;    }    if (status != null)        done(service, "start");}function restart_process(grid){    var service = $$(grid).get(0).children[1].innerText.replace("\n", '');        var del_confirm = confirm('确定启动' + service + '吗?')    if (!del_confirm)        return;        done(service, "restart");}function status_process(grid){    var service = $$(grid).get(0).children[1].innerText.replace("\n", '');    var status = get_status(service);    alert(service + "的状态是" + status);}$$(document).ready(function() {    $$("#grid").vmxGrid({        url : '/model/software/service',        title: "系统服务管理",         buttons : [         {            name : '关闭',            bclass : 'stop',            onpress : stop_process        }        ,{            name : '启动',            bclass : 'start',            onpress : start_process        }        ,{            name : '重启',            bclass : 'restart',            onpress : restart_process        },{            name : '状态',            bclass : 'status',            onpress : status_process        }]    });});</script></head><body><div id="grid"></div></body></html>